<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khagesh ai-nexa | Ultimate Khata Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #020617; color: white; }
        .neon-box { border: 1px solid rgba(56, 189, 248, 0.2); background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px); }
        .gradient-text { background: linear-gradient(90deg, #38bdf8, #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="p-4 md:p-10 min-h-screen">

    <div class="max-w-md mx-auto">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-extrabold tracking-tighter gradient-text">Khagesh ai-nexa</h1>
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Ultimate Ledger v4.0</p>
            </div>
            <div class="text-right italic">
                <div id="liveClock" class="text-xl font-black text-white">00:00:00</div>
                <div id="liveDate" class="text-[8px] text-sky-400 font-bold uppercase tracking-widest">Loading...</div>
            </div>
        </div>

        <div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-[2.5rem] p-8 border border-white/10 shadow-2xl mb-8 relative overflow-hidden">
            <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Available Balance</p>
            <h2 id="mainBalance" class="text-5xl font-black mt-2 tracking-tighter text-sky-400 italic">₹ 0</h2>
            <div class="mt-8 grid grid-cols-2 gap-3">
                <div class="bg-emerald-500/10 p-4 rounded-2xl border border-emerald-500/20">
                    <p class="text-[8px] text-emerald-400 font-black uppercase">Cash In</p>
                    <p id="totalIn" class="text-lg font-bold">₹ 0</p>
                </div>
                <div class="bg-rose-500/10 p-4 rounded-2xl border border-rose-500/20">
                    <p class="text-[8px] text-rose-400 font-black uppercase">Cash Out</p>
                    <p id="totalOut" class="text-lg font-bold">₹ 0</p>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-10 text-center font-black">
            <button onclick="openModal('income')" class="bg-emerald-500 p-5 rounded-3xl shadow-lg shadow-emerald-500/20 active:scale-95 transition-all">GAI (+)</button>
            <button onclick="openModal('expense')" class="bg-rose-500 p-5 rounded-3xl shadow-lg shadow-rose-500/20 active:scale-95 transition-all">DIYA (-)</button>
        </div>

        <h3 class="text-xs font-black text-slate-500 uppercase tracking-[0.2em] mb-4 px-2 italic">Detailed Transactions</h3>
        <div id="ledgerItems" class="space-y-4"></div>
    </div>

    <div id="modal" class="fixed inset-0 bg-black/95 backdrop-blur-xl hidden flex items-center justify-center p-6 z-50">
        <div class="bg-slate-900 p-8 rounded-[3rem] w-full max-w-sm border border-slate-700 shadow-2xl">
            <h2 id="modalTitle" class="text-2xl font-black mb-6 text-sky-400">Entry Detail</h2>
            <div class="space-y-4">
                <input id="eName" type="text" placeholder="Patient/Client Name" class="w-full bg-slate-800 p-4 rounded-2xl outline-none focus:ring-2 focus:ring-sky-500">
                <input id="ePhone" type="number" placeholder="WhatsApp Number" class="w-full bg-slate-800 p-4 rounded-2xl outline-none focus:ring-2 focus:ring-sky-500">
                <input id="eDesc" type="text" placeholder="Description (What for?)" class="w-full bg-slate-800 p-4 rounded-2xl outline-none focus:ring-2 focus:ring-sky-500">
                <input id="eAmount" type="number" placeholder="Amount ₹" class="w-full bg-slate-800 p-4 rounded-2xl font-bold text-xl outline-none focus:ring-2 focus:ring-sky-500">
            </div>
            <div class="flex gap-4 mt-8">
                <button onclick="closeModal()" class="flex-1 font-bold text-slate-500">Close</button>
                <button onclick="saveEntry()" class="flex-[2] bg-sky-500 p-4 rounded-2xl font-black">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        let currentType = '';
        let records = JSON.parse(localStorage.getItem('kh_khata_ultra')) || [];

        function updateClock() {
            const now = new Date();
            document.getElementById('liveClock').innerText = now.toLocaleTimeString('en-IN', { hour12: false });
            document.getElementById('liveDate').innerText = now.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' });
        }
        setInterval(updateClock, 1000); updateClock();

        function openModal(type) { currentType = type; document.getElementById('modal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('modal').classList.add('hidden'); }

        function saveEntry() {
            const name = document.getElementById('eName').value;
            const phone = document.getElementById('ePhone').value || '';
            const desc = document.getElementById('eDesc').value || 'General';
            const amount = parseFloat(document.getElementById('eAmount').value);
            
            if(!name || !amount) return alert("Fill Name & Amount");
            
            records.push({ name, phone, desc, amount, type: currentType, time: new Date().toLocaleString('en-IN', { hour: '2-digit', minute: '2-digit' }) });
            localStorage.setItem('kh_khata_ultra', JSON.stringify(records));
            
            // Clear & Render
            ['eName', 'ePhone', 'eDesc', 'eAmount'].forEach(id => document.getElementById(id).value = '');
            closeModal(); render();
        }

        function shareWA(name, amount, type, phone) {
            if(!phone) return alert("No phone number added!");
            const msg = `Khagesh ai-nexa Update:\nName: ${name}\nAmount: ₹${amount} (${type === 'income' ? 'Received' : 'Paid'})\nTime: ${new Date().toLocaleTimeString()}`;
            window.open(`https://wa.me/91${phone}?text=${encodeURIComponent(msg)}`);
        }

        function render() {
            const list = document.getElementById('ledgerItems');
            let tIn = 0, tOut = 0; list.innerHTML = '';
            records.slice().reverse().forEach(item => {
                if(item.type === 'income') tIn += item.amount; else tOut += item.amount;
                list.innerHTML += `
                    <div class="bg-slate-900/50 p-6 rounded-[2rem] border border-white/5 space-y-3">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-bold text-white text-lg">${item.name}</h4>
                                <p class="text-[10px] text-slate-500 font-bold italic uppercase tracking-wider">${item.desc}</p>
                            </div>
                            <p class="font-black text-xl ${item.type === 'income' ? 'text-emerald-400' : 'text-rose-400'}">${item.type === 'income' ? '+' : '-'} ₹${item.amount}</p>
                        </div>
                        <div class="flex gap-2 pt-2 border-t border-white/5">
                            <button onclick="shareWA('${item.name}', '${item.amount}', '${item.type}', '${item.phone}')" class="flex-1 bg-emerald-500/20 text-emerald-400 py-2 rounded-xl text-[10px] font-bold uppercase">WhatsApp</button>
                            <a href="tel:${item.phone}" class="flex-1 bg-sky-500/20 text-sky-400 py-2 rounded-xl text-[10px] font-bold uppercase text-center">Call Now</a>
                        </div>
                    </div>`;
            });
            document.getElementById('mainBalance').innerText = `₹ ${tIn - tOut}`;
            document.getElementById('totalIn').innerText = `₹ ${tIn}`; document.getElementById('totalOut').innerText = `₹ ${tOut}`;
        }
        render();
    </script>
</body>
    </html>
    
